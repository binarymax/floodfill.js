<!doctype html>
<html>
<head>
    <meta charset="utf8" />
    <title>floodfill.js</title>
    <style>
        .border {border:1px solid #ccc;}
        td {width:400px;border-bottom:1px solid #eee;border-top:1px solid #eee;}
    </style>
</head>
<body>
    
    <table>
        <tr>
            <td>
                <h2>Circle Before</h2>
                <img id="image_circle" src="circle.png" class="border" />
            </td><td>
                <h2>Circle After</h2>
                <canvas id="canvas_circle" width="128" height="128" class="border"></canvas>
            </td>
        </tr>
        <tr>
            <td>
                <h2>Circle Anti-alias Before</h2>
                <img id="image_circle_spec" src="circle.png" class="border" />
            </td><td>
                <h2>Circle Anti-alias After</h2>
                <canvas id="canvas_circle_spec" width="128" height="128" class="border"></canvas>
            </td>
        </tr>
        <tr>
            <td>
                <h2>Star Before</h2>
                <img id="image_star" src="star.png" class="border" />
            </td><td>
                <h2>Star After</h2>
                <canvas id="canvas_star" width="128" height="128" class="border"></canvas>
            </td>
        </tr>
        <tr>
            <td>
                <h2>Star Crop Before</h2>
                <img id="image_star_crop" src="star.png" class="border" />
            </td><td>
                <h2>Star Crop After</h2>
                <canvas id="canvas_star_crop" width="128" height="128" class="border"></canvas>
            </td>
        </tr>
        <tr>
            <td>
                <h2>Circle Before Clear</h2>
                <img id="image_circle_clear" src="circle.png" class="border" />
            </td><td>
                <h2>Circle After Clear</h2>
                <canvas id="canvas_circle_clear" width="128" height="128" class="border"></canvas>
            </td>
        </tr>
        <tr>
            <td>
                <h2>Circle Before Tolerance</h2>
                <img id="image_circle_tolerance" src="circle.png" class="border" />
            </td><td>
                <h2>Circle After Tolerance</h2>
                <canvas id="canvas_circle_tolerance" width="128" height="128" class="border"></canvas>
            </td>
        </tr>
        <tr>
            <td>
                <h2>Circle ArrayBuffer Before</h2>
                <img id="image_circle_array" src="circle.png" class="border" />
            </td><td>
                <h2>Circle ArrayBuffer After</h2>
                <canvas id="canvas_circle_array" width="128" height="128" class="border"></canvas>
            </td>
        </tr>
        <tr>
            <td>
                <h2>Circle Close Tolerance Before</h2>
                <img id="image_circle_close" src="circle.png" class="border" />
            </td><td>
                <h2>Circle Close Tolerance After</h2>
                <canvas id="canvas_circle_close" width="128" height="128" class="border"></canvas>
            </td>
        </tr>

        <tr>
            <td>
                <h2>Circle Bounds Bug Test Before</h2>
                <img id="image_circle_bounds_bug" src="circle.png" class="border" />
            </td><td>
                <h2>Circle Bounds Bug Test After</h2>
                <canvas id="canvas_circle_bounds_bug" width="128" height="128" class="border"></canvas>
            </td>
        </tr>

    </table>

        <!--

    <script type="text/javascript">
        (function(){
            var min = window.location.search.indexOf("min=1")>=0;
            var scr = min?'../floodfill.min.js':'../floodfill.js';
            var str = '<script type="text/javascript" src="'+scr+'"></script>';
            document.write(str);
        })();
    </script>
        //-->

    <script type="text/javascript" src="../floodfill.min.js"></script>

    <script type="text/javascript">
        
        //Circle default fill
        var circle = document.getElementById('image_circle');
        circle.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_circle');
            var context = canvas.getContext('2d');
            context.drawImage(circle, 0, 0);

            // Flood fill the circle starting at point (50, 75) using the color red (255, 0, 0)
            //var color = { r: 255, g: 0, b: 0, a: 255 };
            context.fillStyle = "rgba(255,0,0,1)";
            context.fillFlood(50, 75);

        }

        //Circle spec fill
        var circle_spec = document.getElementById('image_circle_spec');
        circle_spec.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_circle_spec');
            var context = canvas.getContext('2d');
            context.drawImage(circle, 0, 0);

            // Flood fill the circle starting at point (50, 75) using the color red (255, 0, 0)
            context.fillStyle = "rgba(255,0,0,1)";
            context.fillFlood(50, 75, 128, 0, 0, circle.width, circle.height);

        }

        //Star boundary fill
        var star = document.getElementById('image_star');
        star.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_star');
            var context = canvas.getContext('2d');
            context.drawImage(star, 0, 0);

            // Flood fill the star starting at point (5, 5) using the color red (255, 0, 0)
            context.fillStyle = "rgba(255,0,0,1)";
            context.fillFlood(5, 5, 0, 0, 0, star.width, star.height);

        }

        //Star boundary fill cropped
        var star_crop = document.getElementById('image_star_crop');
        star_crop.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_star_crop');
            var context = canvas.getContext('2d');
            context.drawImage(star, 0, 0);

            // Flood fill the star starting at point (5, 5) using the color red (255, 0, 0)
            context.fillStyle = "rgba(255,0,0,1)";
            context.fillFlood(30, 30, 128, 20, 20, 80,80);

        }

        //Circle Clear
        var circle_clear = document.getElementById('image_circle_clear');
        circle_clear.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_circle_clear');
            var context = canvas.getContext('2d');
            context.drawImage(circle_clear, 0, 0);

            // Flood fill the circle starting at point (50, 75) using the color red (255, 0, 0)
            context.fillStyle = "rgba(255,0,0,1)";
            context.fillFlood(50, 75);

            // Flood fill the circle_clear starting at point (50, 75) using the color red (255, 0, 0)
            context.fillStyle = "rgba(1,0,0,0)";
            context.fillFlood(50, 75);

        }

        //Circle Clear
        var circle_tolerance = document.getElementById('image_circle_tolerance');
        circle_tolerance.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_circle_tolerance');
            var context = canvas.getContext('2d');
            context.drawImage(circle_tolerance, 0, 0);
           
            // Test various tolerance levels 
            context.fillStyle = "rgba(255,0,0,1)";
            context.fillFlood(50, 75, 255, 0, 0, circle_tolerance.width, circle_tolerance.height);
            
            context.fillStyle = "rgba(0,255,0,1)";
            context.fillFlood(50, 75, 0, 0, 0, circle_tolerance.width, circle_tolerance.height);
            
            context.fillStyle = "rgba(0,0,255,1)";
            context.fillFlood(50, 75, -999, 0, 0, circle_tolerance.width, circle_tolerance.height);
            
            context.fillStyle = "rgba(255,255,0,1)";
            context.fillFlood(50, 75, null, 0, 0, circle_tolerance.width, circle_tolerance.height);
            
            context.fillStyle = "rgba(255,255,255,1)";
            context.fillFlood(50, 75, '123', 0, 0, circle_tolerance.width, circle_tolerance.height);

            context.fillStyle = "#ffffff";
            context.fillFlood(50, 75, '123', 0, 0, circle_tolerance.width, circle_tolerance.height);            

        }

        //Circle Clear
        var circle_array = document.getElementById('image_circle_array');
        circle_array.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_circle_array');
            var context = canvas.getContext('2d');
            context.drawImage(circle_tolerance, 0, 0);

            var image = context.getImageData(0,0,circle_array.width,circle_array.height);
            var result = floodfill(image.data,50,50,{r:255,g:255,b:0,a:255},128,image.width,image.height);
            context.putImageData(image,0,0);

        }

        //Circle Clear
        var circle_close = document.getElementById('image_circle_close');
        circle_close.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_circle_close');
            var context = canvas.getContext('2d');
            context.drawImage(circle_close, 0, 0);
           
            // Test various tolerance levels 
            context.fillStyle = "rgba(255,0,0,1)";
            context.fillFlood(50.1, 75, 0, 0, 0, circle_close.width, circle_close.height);
            
            context.fillStyle = "rgba(254,0,0,1)";
            context.fillFlood(50, 75.2, 1, 0, 0, circle_close.width, circle_close.height);
            
        }


        //Out-of-Bounds bug test
        var circle_bounds_bug = document.getElementById('image_circle_close');
        circle_bounds_bug.onload = function() {

            // Create a canvas with which we can edit an image
            var canvas = document.getElementById('canvas_circle_bounds_bug');
            var context = canvas.getContext('2d');
            context.drawImage(circle_bounds_bug, 0, 0);
           
            // Test lots of things
            for(var i=0;i<200;i++) {
                context.fillStyle = "rgba(255,"+i+",0,1)";
                context.fillFlood(50, 75, i, 0, 0, circle_bounds_bug.width, circle_bounds_bug.height);
            }
            
        }

    </script>
</body>
</html>
